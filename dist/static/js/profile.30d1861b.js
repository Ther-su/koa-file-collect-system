(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["profile"],{2327:function(e,s,o){},"4ff0":function(e,s,o){"use strict";o("2327")},ecac:function(e,s,o){"use strict";o.r(s);var r=function(){var e=this,s=e.$createElement,o=e._self._c||s;return o("div",{staticClass:"profile-container"},[o("el-card",[o("el-form",{ref:"infoFormRef",attrs:{model:e.userInfo,"status-icon":"",rules:e.infoFormRules,size:"small"}},[o("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[o("el-input",{attrs:{"prefix-icon":"el-icon-user",disabled:!e.isModifyStudentInfo},model:{value:e.userInfo.userName,callback:function(s){e.$set(e.userInfo,"userName",s)},expression:"userInfo.userName"}})],1),o("el-form-item",{attrs:{prop:"fullName",label:"真实姓名"}},[o("el-input",{attrs:{disabled:!e.isModifyStudentInfo},model:{value:e.userInfo.fullName,callback:function(s){e.$set(e.userInfo,"fullName",s)},expression:"userInfo.fullName"}},[o("span",{staticClass:"svg-container",attrs:{slot:"prefix"},slot:"prefix"},[o("svg-icon",{attrs:{"icon-class":"full-name"}})],1)])],1),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择",disabled:!e.isModifyStudentInfo},model:{value:e.userInfo.gender,callback:function(s){e.$set(e.userInfo,"gender",s)},expression:"userInfo.gender"}},[o("el-option",{attrs:{label:"男",value:"1"}}),o("el-option",{attrs:{label:"女",value:"2"}})],1)],1),o("el-form-item",{attrs:{label:"班级代号"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.userInfo.gradeId,callback:function(s){e.$set(e.userInfo,"gradeId",s)},expression:"userInfo.gradeId"}},[o("span",{staticClass:"svg-container",attrs:{slot:"prefix"},slot:"prefix"},[o("svg-icon",{attrs:{"icon-class":"grade"}})],1)]),o("el-button",{staticStyle:{"margin-top":"8px"},attrs:{type:"success",icon:"el-icon-document-copy"},on:{click:e.copy}},[e._v("复制")])],1),o("el-form-item",{attrs:{prop:"school",label:"学校"}},[o("el-input",{attrs:{disabled:!e.isModifyAdminInfo},model:{value:e.userInfo.school,callback:function(s){e.$set(e.userInfo,"school",s)},expression:"userInfo.school"}},[o("span",{staticClass:"svg-container",attrs:{slot:"prefix"},slot:"prefix"},[o("svg-icon",{attrs:{"icon-class":"school"}})],1)])],1),o("el-form-item",{attrs:{prop:"major",label:"专业"}},[o("el-input",{attrs:{disabled:!e.isModifyAdminInfo},model:{value:e.userInfo.major,callback:function(s){e.$set(e.userInfo,"major",s)},expression:"userInfo.major"}},[o("span",{staticClass:"svg-container",attrs:{slot:"prefix"},slot:"prefix"},[o("svg-icon",{attrs:{"icon-class":"major"}})],1)])],1),o("el-form-item",{attrs:{prop:"gradeName",label:"班级"}},[o("el-input",{attrs:{disabled:!e.isModifyAdminInfo},model:{value:e.userInfo.gradeName,callback:function(s){e.$set(e.userInfo,"gradeName",s)},expression:"userInfo.gradeName"}},[o("span",{staticClass:"svg-container",attrs:{slot:"prefix"},slot:"prefix"},[o("svg-icon",{attrs:{"icon-class":"grade"}})],1)])],1),o("el-form-item",[e.isModifyStudentInfo?o("el-button",{attrs:{type:"info"},on:{click:function(s){e.isModifyStudentInfo=!1}}},[e._v("取消")]):e._e(),o("el-button",{attrs:{type:e.isModifyStudentInfo?"danger":"info",loading:e.loading},on:{click:e.modifyUserInfo}},[e._v(e._s(e.isModifyStudentInfo?"确认修改":"修改个人信息"))]),o("el-button",{attrs:{type:"primary"},on:{click:function(s){e.dialogVisible=!0}}},[e._v("修改密码")])],1)],1)],1),o("el-dialog",{attrs:{title:"修改密码",visible:e.dialogVisible},on:{"update:visible":function(s){e.dialogVisible=s}}},[o("el-form",{ref:"passwordFormRef",attrs:{model:e.passwordForm,"status-icon":"",rules:e.passwordFormRules}},[o("el-form-item",{attrs:{prop:"oldPassword",label:"旧密码"}},[o("el-input",{attrs:{"prefix-icon":"el-icon-lock",type:"password"},model:{value:e.passwordForm.oldPassword,callback:function(s){e.$set(e.passwordForm,"oldPassword",s)},expression:"passwordForm.oldPassword"}})],1),o("el-form-item",{attrs:{prop:"newPassword",label:"新密码"}},[o("el-input",{attrs:{"prefix-icon":"el-icon-lock",type:"password"},model:{value:e.passwordForm.newPassword,callback:function(s){e.$set(e.passwordForm,"newPassword",s)},expression:"passwordForm.newPassword"}})],1)],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(s){e.dialogVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.changePassword}},[e._v("确 定")])],1)],1)],1)},t=[],a=o("d211"),i=o("cf6b"),n=o("61f7"),l={name:"Profile",data:function(){return{dialogVisible:!1,loading:!1,isModifyStudentInfo:!1,isModifyAdminInfo:!1,passwordForm:{oldPassword:"",newPassword:""},passwordFormRules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{validator:Object(n["a"])(n["i"],"密码由6-10个字符的字母和汉字组成"),trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:Object(n["a"])(n["i"],"密码由6-10个字符的字母和汉字组成"),trigger:"blur"}]},infoFormRules:{userName:[{required:!0,message:"请输入登录用户名",trigger:"blur"},{validator:Object(n["a"])(n["l"],"用户名为2-10个字符的数字、字母、汉字"),trigger:"blur"}],fullName:[{required:!0,message:"请输入真实姓名",trigger:"blur"},{validator:Object(n["a"])(n["e"],"姓名为2-10个字符的字母或汉字"),trigger:"blur"}],gender:[{required:!0,message:"请输入性别",trigger:"blur"}],gradeName:[{required:!0,message:"请输入班级",trigger:"blur"},{validator:Object(n["a"])(n["f"],"班级代号由2-15个字符组成"),trigger:"blur"}],school:[{required:!0,message:"请输入学校",trigger:"blur"},{validator:Object(n["a"])(n["j"],"学校由2-30个字符组成"),trigger:"blur"}],major:[{required:!0,message:"请输入专业",trigger:"blur"},{validator:Object(n["a"])(n["h"],"专业由2-15个字符组成"),trigger:"blur"}]}}},methods:{copy:function(){var e=document.createElement("input");e.value=this.userInfo.gradeId,document.body.appendChild(e),e.select(),document.execCommand("Copy"),document.body.removeChild(e),this.$message({message:"复制成功",type:"success"})},modifyUserInfo:function(){var e=this;"admin"===this.userInfo.role&&!1===this.isModifyAdminInfo?this.isModifyAdminInfo=!0:"admin"===this.userInfo.role&&!0===this.isModifyAdminInfo&&(this.isModifyAdminInfo=!1),this.isModifyStudentInfo?(this.isModifyStudentInfo=!1,this.$refs.infoFormRef.validate((function(s){if(!s)return!1;e.loading=!0,e.$store.dispatch("user/modifyInfo",e.userInfo).then((function(){e.loading=!1,e.$message({message:"修改成功",type:"success"})})).catch((function(s){e.loading=!1}))}))):this.isModifyStudentInfo=!0},changePassword:function(){var e=this;this.$refs.passwordFormRef.validate((function(s){if(!s)return!1;e.$store.dispatch("user/changePassword",e.passwordForm).then((function(){e.$message({message:"修改密码成功",type:"success"}),e.dialogVisible=!1,e.passwordForm.oldPassword="",e.passwordForm.newPassword=""})).catch((function(s){e.dialogVisible=!1,e.passwordForm.oldPassword="",e.passwordForm.newPassword=""}))}))}},computed:Object(a["a"])({},Object(i["b"])({userInfo:function(e){return e.user}}))},d=l,u=(o("4ff0"),o("5d22")),f=Object(u["a"])(d,r,t,!1,null,null,null);s["default"]=f.exports}}]);